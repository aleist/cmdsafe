syntax = "proto3";

package cmdsafe;
option go_package = "data";

message Config {
  bytes hash = 1;
  ScryptConfig scrypt = 2;
}

message ScryptConfig {
  bytes salt = 1;
  int64 n = 2;
  int32 r = 3;
  int32 p = 4;
}

message Command {
  string name = 1;
  repeated string args = 2;
}

message CryptoEnvelope {
  bytes hmac = 1; // The hmac of iv+data (in this order).
  bytes iv = 2;   // The initialization vector.
  bytes data = 3; // The encrypted data.
}
